<!doctype html>
<html lang="hu">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Tizedes törtek – osztás egész számmal (10 feladat)</title>
  <style>
    :root { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }
    body { margin:0; background:#f6f7fb; color:#111; }
    .wrap { max-width: 980px; margin: 0 auto; padding: 20px; }
    h1 { font-size: 20px; margin: 0 0 6px; }
    .sub { margin: 0 0 16px; color:#444; }
    .controls { display:flex; gap:14px; flex-wrap:wrap; align-items:center; margin: 12px 0 18px; }
    button{
      border:0; padding:10px 14px; border-radius:10px; cursor:pointer;
      background:#1f6feb; color:#fff; font-weight:800;
    }
    button.secondary{ background:#2b2f36; }
    button:disabled{ opacity:.55; cursor:not-allowed; }
    .score{
      font-weight:900; font-size:18px; background:#eef2ff; color:#243b8a;
      padding:8px 14px; border-radius:999px;
    }
    .grid{ display:grid; gap:12px; }
    .card{
      background:#fff; border-radius:14px; padding:14px;
      box-shadow:0 6px 18px rgba(0,0,0,.06);
      border: 1px solid rgba(0,0,0,.06);
    }
    .meta{ display:flex; justify-content:space-between; gap:10px; flex-wrap:wrap; align-items:center; }
    .tag{ font-size:12px; padding:4px 8px; border-radius:999px; background:#eef2ff; color:#243b8a; }
    .task{ margin:10px 0 12px; font-size:20px; }
    .mono{ font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; }
    .answerRow{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
    input[type="text"]{
      padding:10px 12px; border-radius:10px; border:1px solid #cfd6e4;
      min-width:220px; font-size:16px;
    }
    input:disabled{ background:#f1f3f8; }
    .hint{ font-size:12px; color:#666; }
    .result{ margin-top:10px; font-size:14px; }
    .ok{ color:#0a7a2f; font-weight:900; }
    .bad{ color:#b00020; font-weight:900; }
    .small{ font-size:12px; color:#555; margin-top:4px; }
  </style>
</head>

<body>
  <div class="wrap">
    <h1>Tizedes törtek – osztás egész számmal</h1>
    <p class="sub">
      10 feladat: 5× <b>1 számjegyű</b> osztó és 5× <b>2 számjegyű</b> osztó.
      Az osztandó egész része max. <b>999</b>, a törtrész legfeljebb <b>ezred</b>.
    </p>

    <div class="controls">
      <button id="checkBtn">Ellenőrzés</button>
      <button id="newBtn" class="secondary">Új feladatsor</button>
      <div id="score" class="score">0/10</div>
    </div>

    <div id="tasks" class="grid"></div>

    <p class="sub">
      Válaszformátum: tizedes szám (elfogadott: vessző vagy pont). Példa: <span class="mono">34,456 : 3 =</span>
    </p>
  </div>

<script>
(() => {
  const tasksEl = document.getElementById("tasks");
  const checkBtn = document.getElementById("checkBtn");
  const newBtn = document.getElementById("newBtn");
  const scoreEl = document.getElementById("score");

  let problems = [];
  let locked = false;

  const rndInt = (a,b) => Math.floor(Math.random()*(b-a+1))+a;
  const pick = (arr) => arr[Math.floor(Math.random()*arr.length)];

  // osztandó: egész 0..999, tört rész max ezred (0-3 tizedesjegy, de tipikusan 1-3)
  function makeDividend(){
    const intPart = rndInt(0, 999);
    const dp = pick([1,2,3]);            // tized/század/ezred
    const fracMax = Math.pow(10, dp) - 1;
    let frac = rndInt(0, fracMax);
    if(frac === 0 && Math.random() < 0.7) frac = rndInt(1, fracMax);

    const value = intPart + frac / Math.pow(10, dp);
    return { value, dp };
  }

  function hu(v){
    let s = Number(v).toFixed(6);
    s = s.replace(/\.?0+$/,''); // felesleges nullák le
    return s.replace('.', ',');
  }

  function parseHu(str){
    if(!str) return NaN;
    return Number(String(str).trim().replace(/\s+/g,'').replace(',', '.'));
  }

  function almostEqual(a,b){
    return Math.abs(a - b) <= 0.0005;
  }

  // Pontosabb osztás: tizedesjegyek alapján egészre skálázás
  function exactDiv(dividend, divisor){
    // dividend max ezred -> legfeljebb 3 tizedesjegy
    const s = String(dividend);
    const dp = (s.split('.')[1] || '').length;
    const scaled = Math.round(dividend * Math.pow(10, dp)); // egész
    return (scaled / divisor) / Math.pow(10, dp);
  }

  function makeProblem(divisorDigits){
    const d = makeDividend().value;
    const divisor = (divisorDigits === 1) ? rndInt(2,9) : rndInt(10,99);

    const ans = exactDiv(d, divisor);

    return {
      kind: divisorDigits === 1 ? "1 számjegyű osztó" : "2 számjegyű osztó",
      text: `${hu(d)} : ${divisor} =`,
      ans
    };
  }

  function buildUI(){
    tasksEl.innerHTML = "";
    problems.forEach((p, i) => {
      const card = document.createElement("div");
      card.className = "card";
      card.innerHTML = `
        <div class="meta">
          <div class="tag">${i+1}. feladat • ${p.kind}</div>
          <div class="hint">Írd be az eredményt!</div>
        </div>
        <div class="task mono">${p.text}</div>
        <div class="answerRow">
          <label for="a${i}"><b>Válasz:</b></label>
          <input id="a${i}" type="text" placeholder="pl. 11,485333..." inputmode="decimal" ${locked ? "disabled" : ""}/>
          <span class="hint">vessző vagy pont</span>
        </div>
        <div id="r${i}" class="result"></div>
      `;
      tasksEl.appendChild(card);
    });
  }

  function newSet(){
    locked = false;
    checkBtn.disabled = false;
    scoreEl.textContent = "0/10";

    const list = [];
    for(let i=0;i<5;i++) list.push(makeProblem(1));
    for(let i=0;i<5;i++) list.push(makeProblem(2));

    // keverés
    for (let i = list.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [list[i], list[j]] = [list[j], list[i]];
    }

    problems = list;
    buildUI();
  }

  function lockInputs(){
    locked = true;
    problems.forEach((_, i) => {
      const inp = document.getElementById(`a${i}`);
      if (inp) inp.disabled = true;
    });
    checkBtn.disabled = true;
  }

  function check(){
    let good = 0;

    problems.forEach((p, i) => {
      const inp = document.getElementById(`a${i}`);
      const out = document.getElementById(`r${i}`);
      const userVal = parseHu(inp.value);

      if (Number.isNaN(userVal)){
        out.innerHTML = `<span class="bad">Hiányzó vagy hibás szám.</span>
                         <div class="small">Adj meg egy tizedes számot (pl. 3,25).</div>`;
        return;
      }

      const ok = almostEqual(userVal, p.ans);
      if (ok){
        good++;
        out.innerHTML = `<span class="ok">Helyes!</span>
                         <div class="small">Eredmény: ${hu(p.ans)}</div>`;
      } else {
        out.innerHTML = `<span class="bad">Nem jó.</span>
                         <div class="small">Helyes eredmény: <b>${hu(p.ans)}</b></div>`;
      }
    });

    scoreEl.textContent = `${good}/10`;
    lockInputs();
  }

  newBtn.addEventListener("click", newSet);
  checkBtn.addEventListener("click", check);

  newSet();
})();
</script>
</body>
</html>
